{% extends "layouts/auth.html" %}

{% block content %}
<div class="mt-20 w-full max-w-screen-lg mx-auto px-4 sm:px-6 lg:px-8 space-y-6">
  <div class="bg-white shadow rounded-lg p-6 border border-gray-100">
    <p class="text-sm uppercase tracking-wide text-indigo-600 font-semibold">Protected Demo</p>
    <h1 class="mt-2 text-2xl font-bold text-gray-900">Sandboxed Feature Page</h1>
    <p class="mt-3 text-gray-600 leading-relaxed">
      This page replaces the old WebSocket demo with a neutral protected area you can wire up to any
      experiment (feature flags, dashboard widgets, etc.). Keep the route behind authentication to
      validate middleware, CSRF tokens, and template helpers in one place.
    </p>
    <div class="mt-4 flex flex-wrap gap-3">
      <a href="/me" class="inline-flex items-center px-4 py-2 rounded-md bg-indigo-600 text-white text-sm font-medium hover:bg-indigo-500 transition-colors">
        Back to Profile
      </a>
      <a href="/" class="inline-flex items-center px-4 py-2 rounded-md border border-gray-300 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors">
        Home
      </a>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <div class="bg-blue-50 border border-blue-100 rounded-lg p-5">
      <h2 class="text-lg font-semibold text-blue-900">What to build here?</h2>
      <ul class="mt-3 text-sm text-blue-800 list-disc list-inside space-y-1">
        <li>Drop in WebSocket or SSE demos that need authenticated actors.</li>
        <li>Prototype admin dashboards or tenant-aware widgets.</li>
        <li>Exercise CSRF helpers by embedding forms or fetch requests.</li>
        <li>Showcase custom claims or resource roles from issued JWTs.</li>
      </ul>
    </div>

    <div class="bg-white border border-gray-200 rounded-lg p-5 shadow-sm">
      <h2 class="text-lg font-semibold text-gray-900">Current Actor Context</h2>
      {% if actor %}
        <dl class="mt-4 text-sm text-gray-700 space-y-2">
          <div class="flex justify-between">
            <dt class="font-medium">Actor ID</dt>
            <dd class="font-mono">{{ actor.ActorID|default:"unknown" }}</dd>
          </div>
          <div class="flex justify-between">
            <dt class="font-medium">Role</dt>
            <dd class="capitalize">{{ actor.Role|default:"guest" }}</dd>
          </div>
          <div class="flex justify-between">
            <dt class="font-medium">Tenant</dt>
            <dd class="font-mono">{{ actor.TenantID|default:"n/a" }}</dd>
          </div>
          <div class="flex justify-between">
            <dt class="font-medium">Impersonated?</dt>
            <dd>
              {% if actor.IsImpersonated %}
                Yes
              {% else %}
                No
              {% endif %}
            </dd>
          </div>
        </dl>
      {% else %}
        <p class="mt-4 text-gray-600">
          No actor context was found. Ensure this route is wrapped with <code>ProtectedRoute</code>
          and the JWT middleware has run.
        </p>
      {% endif %}
    </div>
  </div>

  <div class="bg-gray-50 border border-dashed border-gray-300 rounded-lg p-5">
    <h2 class="text-lg font-semibold text-gray-900">Next Steps</h2>
    <p class="mt-2 text-sm text-gray-700">
      Replace this copy with your own widgets or integrate the original WebSocket example here.
      The template already loads the shared layout, csrf helpers, and actor metadata so you can
      quickly iterate on protected experiences.
    </p>
  </div>
</div>
{% endblock %}
